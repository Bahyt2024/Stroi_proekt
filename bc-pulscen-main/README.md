# Система сбора предложений товаров

Этот проект разделен на несколько модулей для лучшей организации кода и упрощения поддержки.

## Структура проекта

### Основные файлы:

- **`main.py`** - Основное FastAPI приложение с эндпоинтами
- **`config.py`** - Конфигурация и константы
- **`models.py`** - Модели данных и функции для работы с городами
- **`utils.py`** - Утилиты и вспомогательные функции
- **`ai_services.py`** - AI сервисы (OpenAI, Perplexity, DaData)
- **`company_extractor.py`** - Извлечение данных о компаниях
- **`pdf_generator.py`** - Генерация PDF документов

### Функциональность:

1. **Поиск товаров** на Pulscen и Perplexity
2. **Извлечение данных** о компаниях через DaData API
3. **Обработка товаров** с помощью AI (OpenAI GPT)
4. **Генерация PDF** отчетов
5. **OCR обработка** скриншотов

### API эндпоинты:

- `POST /test` - Тестовый эндпоинт
- `POST /debug_collect` - Отладочный эндпоинт
- `GET /health` - Проверка состояния сервера
- `POST /simple_test` - Простой тест
- `POST /validate_test` - Тест валидации
- `POST /collect_offers` - Основной эндпоинт для сбора предложений

### Запуск:

```bash
python main.py
```

или

```bash
uvicorn main:app --host 0.0.0.0 --port 8000
```

Если запускаете через ngrok:
```
ngrok start pulscen-api --config ngrok.yml
```
### Требования:

- Python 3.8+
- Playwright
- OpenAI API ключ
- Perplexity API ключ
- DaData API ключ

### Переменные окружения:

- `OPENAI_API_KEY` - Ключ OpenAI API
- `PERPLEXITY_API_KEY` - Ключ Perplexity API

### Преимущества новой структуры:

1. **Модульность** - каждый файл отвечает за свою область
2. **Читаемость** - код легче понимать и поддерживать
3. **Переиспользование** - функции можно использовать в разных частях
4. **Тестируемость** - каждый модуль можно тестировать отдельно
5. **Масштабируемость** - легко добавлять новые функции

